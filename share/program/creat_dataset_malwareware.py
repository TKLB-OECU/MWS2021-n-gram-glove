import json
import difflib

executable_file_id = []
executable_file_strings = []

with open("../data/ffridataset2021_malware.jsonl", "r") as read_file:
    with open("../data/sample-ffridataset2021_malware_100_strings_version2.txt", "w") as save_strings:
        with open("../data/sample-ffridataset2021_malware_100_fuzzyhashes.txt", "w") as save_fuzzyhashes:
            for num, l in enumerate(read_file):
                if num > 100:
                    break
                # ここが一つのjson
                obj = json.loads(l)
                strings = obj["strings"]
                malware_string = "".join(strings)
                save_strings.write(f"{malware_string}\n")
                
                fuzzyhash = obj["hashes"]["ssdeep"]
                save_fuzzyhashes.write(f"{fuzzyhash}\n")
